# Электронная система записи к врачам

Ниже приводится детальный обзор системы «Электронная система записи к врачам» (далее – «Система») с учётом функциональных и нефункциональных требований, а также возможный подход к её проектированию, масштабированию и тестированию.

---

## 1. Общая архитектура и контуры системы

### 1.1 Высокоуровневая архитектура

Чтобы сделать систему гибкой и удобной для дальнейшего масштабирования, будем использовать **микросервисы**. Здесь их мжно выделить несколько!

1. **User/Account Service (Сервис «Управления учётными записями»)**  
   - Регистрация и аутентификация пользователей (пациенты, врачи, администраторы).  
   - Хранение базовых данных профиля: User_Name, Email, Phone, роль (Role_Patient, Role_Doctor, Role_Admin), права доступа, Registration_Date.

2. **Scheduling Service (Сервис «Расписания / Записи»)**  
   - Управление слотами для записи к врачам.  
   - Создание, перенос и отмена записей.  
   - Поддержка логики конфликтов при бронировании слотов (чтобы один слот не заняли несколько пользователей).

3. **Notifications Service (Сервис «Уведомлений»)**  
   - Отправка уведомлений о предстоящих приёмах (Email, SMS, Push-уведомления).  
   - Настройка расписания рассылок, шаблонов уведомлений.

4. **Patient Card Service (Сервис «карточки пациента»)**  
   - Ведение медицинской истории пациента (история приёмов, диагнозы, предписания).  
   - Контролируемый доступ (только врач с соответствующими правами может вносить изменения).  
   - Шифрование/обезличивание (где необходимо).

5. **Payment Service (Если услуга платная)**  
   - Если в системе предполагается онлайн-оплата или учёт оплат за консультации/приёмы.

6. **API Gateway (Шлюз)**  
   - Общая точка входа для внешних клиентов (мобильное приложение, веб-интерфейс).  
   - Авторизация, маршрутизация запросов к нужным микросервисам.

7. **Admin Service** (опционально, может быть частью других сервисов)  
   - Управление расписаниями врачей, создание шаблонов расписания (например, «по вторникам — 10 доступных слотов»), администрирование пользователей и т. д.

---

## 2. Детализация функциональных требований

### 2.1 Регистрация пользователей (пациентов и врачей)

1. **Модели данных**  
   - **User** (сущность/агрегат):  
     - User_ID, Login, Password (хранить в хэшированном виде),  
     - Роль (Role_Patient, Role_Doctor, Role_Admin),  
     - Профиль (User_Name, Email, Phone),  
     - Registration_Date.  
   - **Аутентификация**: JSON Web Token или OAuth2, чтобы обеспечить масштабируемость и единое место проверки токена.

2. **Ограничения и валидация**  
   - Уникальный Login / Phone / Email.  
   - Специальные требования для пароля (К примеру, наличие заглавных, строчных букв, цифр и специальных сервисов) 

### 2.2 Просмотр доступных слотов для записи

1. **Слоты**  
   - Модель: Slot_ID, Start_Datetime, End_Datetime, Doctor_ID, Status (Свободен / Занят / Недоступен / Отменен).  
2. **Фильтрация**  
   - По Doctor_ID, по дате, по специализации врача (если есть), по локации (если врачи работают в разных местах).  
3. **Отображение**  
   - Может быть в календарном виде (UI-календарь) или в виде списка доступных интервалов.

### 2.3 Создание, перенос и отмена записей

1. **Создание записи**  
   - Пациент выбирает свободный слот, отправляет запрос на бронирование, система блокирует слот и создаёт запись (**Appointment**).  
   - **Appointment**:  
     - ID, User_ID, Doctor_ID, Slot_ID,  
     - Статус (Активна, Перенесена, Отменена, Выполнена).

2. **Перенос**  
   - Изменение Slot_ID, если система позволяет перенос на другой слот.  
   - Проверка, что новый слот свободен и принадлежит нужному врачу (или другому — если мы такое разрашаем).

3. **Отмена**  
   - Изменение статуса Appointment на *Отменен*.  
   - Слот становится снова свободным.
